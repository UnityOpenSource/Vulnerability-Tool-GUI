import os
import datetime
import subprocess
from tkinter import *
from reportlab.pdfgen import canvas

def generate_pdf(results, website):
    current_date = datetime.datetime.now().strftime("%Y-%m-%d")
    filename = f"{website}_{current_date}.pdf"
    c = canvas.Canvas(filename)
    c.setFont("Helvetica-Bold", 16)
    c.drawString(50, 800, f"Rezultate scanare vulnerabilități - {website}")
    c.setFont("Helvetica", 12)
    y = 750
    for result in results:
        c.drawString(50, y, result)
        y -= 20
    c.save()
    status_label.config(text=f"Fișierul PDF {filename} a fost generat cu succes.")

def scan_vulnerabilities():
    website = website_entry.get()
    command = f"nmap -p 1-1000 -T4 --script vulners --script-args mincvss=5.0 -oN - {website}"
    process = subprocess.Popen(command, shell=True, stdout=subprocess.PIPE)
    output = process.communicate()[0].decode()
    vulnerabilities = []
    lines = output.split("\n")
    for line in lines:
        if "VULNERABLE" in line:
            vulnerabilities.append(line.strip())
    generate_pdf(vulnerabilities, website)

# Crearea GUI
window = Tk()
window.title("Scanare Vulnerabilități")
window.geometry("400x200")

website_label = Label(window, text="Website:")
website_label.pack()

website_entry = Entry(window, width=30)
website_entry.pack()

scan_button = Button(window, text="Scanare", command=scan_vulnerabilities)
scan_button.pack()

status_label = Label(window, text="")
status_label.pack()

window.mainloop()
